---
title: "Error example blocs"
output:
  rmarkdown::html_vignette:
  #BiocStyle::html_document:
    toc: true
vignette: >
  %\VignetteIndexEntry{Error example blocs}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(gwhap)
```

# Create the blocs
```R
# read the augmented genetic map

# 1000 genome interpolated
augmented_genetic_map_dir = '/neurospin/tmp/ymekki/new_repo/gwhap/augmented_genetic_map_1000_genome_interpolated'
augmented_map_df = get_augmented_genetic_map(augmented_genetic_map_dir, chromosomes=1:23)

# create blocs
sprintf('Start time : %s', Sys.time())
output = '/neurospin/tmp/ymekki/new_repo/gwhap/bloc_using_augmented_genetic_map_1000_genome_interpolated'
create_blocks(augmented_map_df, delta=1e-3, save_blocs=TRUE, output=output)
sprintf('End time : %s', Sys.time())
```

# debugging

## read the augmented genetic map created above
```R
blocs_df = get_blocs('/neurospin/tmp/ymekki/new_repo/gwhap/bloc_using_augmented_genetic_map_1000_genome_interpolated')
```

## Read the blocs -S.K-
```R
load('/neurospin/brainomics/2019_gwhap/data/winDF_all.Rdata')
# filter on the delta
winDF_1e_3 = winDF[winDF$min_cM==1e-3, ]
```


## merging both vlocs df
```R
bloc_df_merged = merge(blocs_df, winDF_1e_3, by.x = 'from_bp', by.y = 'fromBp')
```

```R
summary(bloc_df_merged)
```

|    from_bp        |     start_w   |       end_w    |       win_size     |     to_bp         |     from_cm     |      to_cm      |      chr.x      |     delta       |  
|:------------------|---------------|----------------|--------------------|-------------------|-----------------|-----------------|-----------------|-----------------|
| Min.   :     6157 |  Min.   :    1|   Min.   :    2|   Min.   :0.0000000|Min.   :    10583  |  Min.   :  0.00 |  Min.   :  0.00 |  Min.   : 1.000 | Min.   :0.001   |
| 1st Qu.: 30925512 |  1st Qu.: 7516|   1st Qu.: 7518|   1st Qu.:0.0002846|1st Qu.: 30929898  |  1st Qu.: 48.23 |  1st Qu.: 48.23 |  1st Qu.: 4.000 | 1st Qu.:0.001   | 
| Median : 68406624 |  Median :15675|   Median :15679|   Median :0.0006383|Median : 68415745  |  Median : 84.36 |  Median : 84.35 |  Median : 8.000 | Median :0.001   | 
| Mean   : 78283899 |  Mean   :17584|   Mean   :17587|   Mean   :0.0008175|Mean   : 78290525  |  Mean   : 92.77 |  Mean   : 92.76 |  Mean   : 8.927 | Mean   :0.001   | 
| 3rd Qu.:115392152 |  3rd Qu.:25744|   3rd Qu.:25747|   3rd Qu.:0.0010351|3rd Qu.:115393212  |  3rd Qu.:128.89 |  3rd Qu.:128.89 |  3rd Qu.:13.000 | 3rd Qu.:0.001   | 
| Max.   :249218540 |  Max.   :53259|   Max.   :53260|   Max.   :0.0175690| Max.   :249222527 |  Max.   :286.28 |  Max.   :286.28 |  Max.   :22.000 | Max.   :0.001   |
|                   |               |                |   NA's   :2        |                   |  NA's   :1      |  NA's   :1      |                 |                 |


|    from_bp       |     startW      |   endW         |  winsz             |      toBp        |       fromCM      |       toCM       |      chr.y      |    min_cM      |
|:-----------------|:----------------|----------------|--------------------|------------------|-------------------|------------------|-----------------|---------------:|
| Min.   :     6157|   Min.   :    1 |   Min.   :    2|   Min.   :0.0000000|Min.   :    10583 |   Min.   :  0.00  |   Min.   :  0.00 |  chr2   : 9787  | Min.   :0.001  | 
| 1st Qu.: 30925512|    1st Qu.: 7516|   1st Qu.: 7518|   1st Qu.:0.0002846|1st Qu.: 30929898 |   1st Qu.: 48.23  |   1st Qu.: 48.23 |  chr1   : 9569  | 1st Qu.:0.001  | 
| Median : 68406624|    Median :15675|   Median :15679|   Median :0.0006383|Median : 68415745 |   Median : 84.36  |   Median : 84.36 |  chr3   : 8159  | Median :0.001  | 
| Mean   : 78283899|    Mean   :17584|   Mean   :17587|   Mean   :0.0008175|Mean   : 78290525 |   Mean   : 92.76  |   Mean   : 92.77 |  chr4   : 7774  | Mean   :0.001  | 
| 3rd Qu.:115392152|    3rd Qu.:25744|   3rd Qu.:25747|   3rd Qu.:0.0010351|3rd Qu.:115393212 |   3rd Qu.:128.89  |   3rd Qu.:128.89 |  chr6   : 7502  | 3rd Qu.:0.001  | 
| Max.   :249218540|    Max.   :53259|   Max.   :53260|   Max.   :0.0175690|Max.   :249222527 |   Max.   :286.28  |   Max.   :286.28 |  chr5   : 7203  | Max.   :0.001  |
|                  |                 |                |                    |                  |                   | (Other):69629    |                 |                |

