---
title: "Error example"
output:
  #rmarkdown::html_vignette:
  BiocStyle::html_document:
    toc: true
vignette: >
  %\VignetteIndexEntry{Error example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(gwhap)
```

# Create the augmented genetic map
```R
sprintf('Time de lancement : %s', Sys.time())
snp_physical_positions = "/neurospin/ukb/genetic/GENETIC_DATA_500k/HAPLOTYPES/v2/ukb_hap_"
rutgers_map = "/neurospin/brainomics/bio_resources/rutgers_map_v3"
output = '/neurospin/tmp/ymekki/new_repo/gwhap/augmented_genetic_map_approx_function'
create_augmented_genetic_map(snp_physical_positions=snp_physical_positions, genetic_map_dir=rutgers_map, save_genetic_map=TRUE, output=output)
sprintf('Time de fin : %s', Sys.time())
```

# debugging

## Read the genetic map -S.K-
```R
load("/neurospin/brainomics/2019_gwhap/data/genMap_all.Rdata")
```

## read the augmented genetic map created above
```R
augmented_genetic_map_dir = '/neurospin/tmp/ymekki/new_repo/gwhap/augmented_genetic_map_approx_function'
augmented_map_df = get_augmented_genetic_map(augmented_genetic_map_dir, chromosomes=1:23)
```

## merging both genetic map
```R
df_merged_by_rsid = merge(augmented_map_df, genMap_all, by.x = 'rsid', by.y = 'rsid')
```

```R
head(df_merged_by_rsid, 10)
```

|   |         rsid|     cM.x|    pos.x| chr.x|     cM.y|    pos.y| chr.y|
|:-:|:--------:   |:-------:|:-------:|:----:|:-------:|:-------:|:----:|
|1  |Affx-10000328| 69.75469| 39542062|     1| 67.88376| 39542062|  chr1|
|2  |Affx-10018171| 89.19798| 95705380|    13| 88.61191| 95705380| chr13|
|3  |Affx-10020391| 89.48202| 95859035|    13| 89.13778| 95859035| chr13|
|4  |Affx-10030637| 90.38349| 96638636|    13| 89.85192| 96638636| chr13|
|5  |Affx-10047176| 70.33794| 39917888|     1| 68.08397| 39917888|  chr1|
|6  |Affx-10053866| 92.84715| 98640318|    13| 91.47219| 98640318| chr13|
|7  |Affx-10055540| 93.11267| 98749827|    13| 91.75806| 98749827| chr13|
|8  |Affx-10058161| 93.53999| 98928242|    13| 92.30553| 98928242| chr13|
|9  |Affx-10065209| 94.39447| 99392176|    13| 93.59793| 99392176| chr13|
|10 |Affx-10067946| 94.73818| 99592598|    13| 93.88717| 99592598| chr13|

```R
tail(df_merged_by_rsid, 10)
```

|      |      rsid|       cM.x|     pos.x| chr.x|      cM.y|     pos.y| chr.y|
|:----:|:-----:   |:---------:|:--------:|:----:|:--------:|:--------:|:----:|
|658711| rs9999718|  97.368496|  84762853|     4|  99.46464|  84762853|  chr4|
|658712| rs9999742|  80.998300|  67943855|     4|  83.91372|  67943855|  chr4|
|658713| rs9999789| 118.422721| 110510946|     4| 119.85002| 110510946|  chr4|
|658714| rs9999806|  53.237763|  34952348|     4|  56.18185|  34952348|  chr4|
|658715| rs9999843| 186.957550| 181531165|     4| 190.57694| 181531165|  chr4|
|658716| rs9999852| 170.406669| 168403671|     4| 172.85596| 168403671|  chr4|
|658717|  rs999988|  61.971536|  37635299|     9|  61.67135|  37635299|  chr9|
|658718|  rs999989|  34.952039|   9658077|    18|  28.00999|   9658077| chr18|
|658719| rs9999927| 136.895689| 135945570|     4| 140.13134| 135945570|  chr4|
|658720| rs9999971|   7.884617|   5284714|     4|  10.71974|   5284714|  chr4|


```R
summary(df_merged_by_rsid)
```
|   rsid            |    cM.x         |   pos.x          |      chr.x     |       cM.y      |      pos.y         |       chr.y     |
|:-----------------:|:------------:   |:----------------:|:--------------:|:---------------:|:------------------:|:---------------:|
|Length:658720      | Min.   :  0.00  | Min.   :     6157|   Min.   : 1.00|   Min.   :  0.00|   Min.   :     6157|   chr1   : 53260|  
|Class :character   | 1st Qu.: 49.30  | 1st Qu.: 30294386|   1st Qu.: 4.00|   1st Qu.: 47.98|   1st Qu.: 30294386|   chr2   : 52631|  
|Mode  :character   | Median : 83.11  | Median : 66612348|   Median : 8.00|   Median : 83.15|   Median : 66612348|   chr6   : 45886|  
|                   | Mean   : 91.81  | Mean   : 77478883|   Mean   : 9.01|   Mean   : 92.11|   Mean   : 77478883|   chr3   : 44263|  
|                   | 3rd Qu.:127.33  | 3rd Qu.:114812360|   3rd Qu.:13.00|   3rd Qu.:128.54|   3rd Qu.:114812360|   chr4   : 41213|  
|                   | Max.   :281.50  | Max.   :249222527|   Max.   :22.00|   Max.   :286.28|   Max.   :249222527|   chr5   : 38734|  
|                   | NA's   :1936    |                  |                |                 |                    |   (Other):382733| 


